Для реализации часов предполагается использовать регистр TSC.

В inc/time.h будут объявлена структура timespec и константы CLOCK_MONOTONIC, CLOCK_REALTIME, CLOCK_PROCESS_CPUTIME_ID

Для реализации CLOCK_MONOTONIC и CLOCK_REALTIME в файле kern/tsc.c будут заведены переменные mono_start типа uint64_t и realtime_start типа int64_t.
Переменная mono_start будет инициализирована значением регистра TSC при запуске ядра.
Переменная realtime_start будет инициализирована значением, возвращаемым функцией gettime, переведённым в количество тактов процессора.

Для реализации CLOCK_PROCESS_CPUTIME_ID в структуру Env будет добавлен новый член int64_t env_cputime_start.
Она будет инициализирована значением регистра TSC при создании процесса.

В файле kern/tsc.c будет заведена переменная res, которая будет инициализировна временем одного такта процессора. Такой будет точность всех часов.

В файле kern/tsc.c будут созданы функции
int clock_getres(int clock_id, struct timespec *res);
int clock_gettime(int clock_id, struct timespec *tp);
int clock_settime(int clock_id, const struct timespec *tp);

getres будет записывать по адресу res значение переменной res, описанной выше.

gettime в зависимости от типа будет записывать по адресу tp:
CLOCK_MONOTONIC: разность текущего значения регистра TSC и mono_start, переведённую в секунды и наносекунды
CLOCK_REALTIME: сумму realtime_start и разности текущего значения регистра TSC и mono_start, переведённую в секунды и наносекунды
CLOCK_PROCESS_CPUTIME_ID: разность текущего значения регистра TSC и curenv->env_cputime_start, переведённую в секунды и наносекунды

clock_settime в зависимости от типа:
CLOCK_MONOTONIC: вернёт ошибку
CLOCK_REALTIME: установит realtime_start как разность заданного значения, переведённого в такты процессора, и разности текущего значения регистра TSC и mono_start.
CLOCK_PROCESS_CPUTIME_ID: установит curenv->env_cputime_start как разность заданного значения, переведённого в такты процессора, и разности текущего значения регистра TSC и mono_start.

Для реализации всех вышеназванных функций будут созданы с префиксами sys_ соответствующие системные вызовы в файлах lib/syscall.c и kern/syscall.c

В файле inc/time.h будет создана функция
int clock_nanosleep(int clock_id, int flags, const struct timespec *rqtp, struct timespec *rmtp);
и добавлена константа TIMER_ABSTIME

При установленном флаге TIMER_ABSTIME функция будет выполнять пустой цикл до тех пор, пока функция sys_clock_gettime(clock_id, tp) не вернёт время, большее, чем задано в rqtp.

Если флаг TIMER_ABSTIME не установлен, то будет зафиксировано время начала по часам CLOCK_MONOTONIС (так как относительное время по всем трём часам одинаково,
но только на CLOCK_MONOTONIС нельзя повлиять с помощью clock_settime) и будет выполняться пустой цикл, пока разность времени, возвращённого sys_clock_gettime(CLOCK_MONOTONIС, tp),
и времени начала не станет большее, чем задано в rqtp.

------ТЕСТЫ------
Для проверки правильности работы часов реального времени:
Сравнивать результаты, полученные sys_clock_gettime(CLOCK_REALTIME, tp) и sys_gettime. Допустимая погрешность - 1 секунда.

Для всех часов: сравнивать время, прошедшее с начала большого цикла, полученное по нашим часам и полученное по часам sys_gettime.

Для часов CLOCK_REALTIME, CLOCK_PROCESS_CPUTIME_ID выставлять новое время функцией sys_clock_settime и сравнивать время, возвращаемое функцией sys_clock_gettime, после большого цикла
с суммой установленного времени и времени, прошедшего с момента начала цикла по часам sys_gettime.

Проверки на некорректные аргументы:
- не существующие clock_id,
- отрицательные значения секунд и наносекунд и значения наносекунд, большее 999 999 999 при установке времени,
- попытка установки времени для часов CLOCK_MONOTONIC

Проверка выравнивания значений устанавливаемого времени по значениям, кратным точности часов:
устанавливаем часы на значения, не выравненные по точности, пробуем получить значение времени, проверяем выравнено ли полученное значение.

Для clock_getres получаемые точности для всех трёх часов должны быть одинаковыми.

Для проверки clock_nanosleep:
Для TIMER_ABSTIME сравнение времени по часам, заданным в clock_id, и времени, заданного в rqtp.
Для не установленного TIMER_ABSTIME сравнение времени, прошедшего по соответствующим часам, со значением в rqtp.

В параллельном процессе во время выполнения clock_nanosleep поменять время с помощью sys_clock_settime.
На TIMER_ABSTIME это должно оказать влияние, если не устанавливать TIMER_ABSTIME, то влияния быть не должно.